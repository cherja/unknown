(function(window, document){document.addEventListener("DOMContentLoaded", function() {"use strict";function initForm(t,e){document.querySelectorAll("."+t).forEach(function(t){t.addEventListener("submit",function(i){if(i.preventDefault(),t.querySelector(".tell").value.length<10)return alert("Убедитесь в правильности введенного номера телефона!");$.ajax({type:"POST",url:"../php/"+e+".php",data:$(t).serialize(),success:function(){alert("Спасибо за обращение, ожидайте звонка оператора!"),successForm(t)},error:function(){alert("Непредвиденная ошибка сервера, обратитесь позже...")}})},!1)})}function successForm(t){t.querySelectorAll('input:not([type="submit"])').forEach(function(t){return t.value=""});var e=t.parentNode;e.classList.contains("remodal")&&$(e).remodal().close()}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},buttonsClassList=document.getElementById("toptbuttons").classList,headerHeight=document.getElementsByTagName("header")[0].offsetHeight,fixedClass="fixed";window.onscroll=function(){window.pageYOffset>=headerHeight?buttonsClassList.add(fixedClass):buttonsClassList.contains(fixedClass)&&buttonsClassList.remove(fixedClass)},Vue.component("typeahead",{template:'<div :class="typeaheadState">\n                    <div class="typeahead__toggle" ref="toggle" @mousedown.prevent="toggle">\n                        <input type="text" class="typeahead__search"\n                            ref="search"\n                            v-model.trim="search"\n                            @focus="onFocus"\n                            @blur="onBlur"\n                            @keydown.esc="onEscape"\n                            @keydown.down="onDownKey"\n                            @keydown.up="onUpKey"\n                            @keydown.enter="onEnterKey"\n                        >\n                        <span class="typeahead__text" ref="text">{{displayText}}</span>\n                    </div>\n                    <ul @mousedown.prevent.stop class="typeahead__list" ref="list" v-if="open" @scroll="onScroll">\n                        <li class="typeahead__item" v-for="(option, index) in filteredOptions" :key="index">\n                            <a class="typeahead__link"\n                                @mousedown.prevent="select(index)"\n                                :class="[selectIndex === index ? \'typeahead__active\' : \'\']">\n                                {{option}}\n                            </a>\n                        </li>\n                        <li class="no_search" v-if="filteredOptions.length === 0">Город не найден...</li>\n                    </ul>\n                </div>',props:{options:{type:Array,default:function(){return[]}},value:{type:[String,Number],default:null},directionText:{type:String,default:null}},data:function(){return{open:!1,selectIndex:0,displayText:this.directionText,search:"",count:15}},computed:{typeaheadState:function(){return this.open?"typeahead typeahead__open":"typeahead"},filteredOptions:function(){var t=this,e=this.options.filter(function(e){var i=e.split("").slice(0,t.search.length).join("");if(t.search.toLowerCase()==i.toLowerCase())return e});return e.length>=this.count&&(e.length=this.count),this.search.length>0?e.sort(function(t,e){var i=t.city.toUpperCase(),n=e.city.toUpperCase(),s=0;return i>n?s=1:i<n&&(s=-1),s}):e}},methods:{onDownKey:function(){this.filteredOptions.length-1>this.selectIndex&&(this.selectIndex++,this.selectIndex>2&&(this.$refs.list.scrollTop+=20+this.selectIndex))},onUpKey:function(){this.selectIndex>0&&(this.selectIndex--,this.selectIndex>0&&(this.$refs.list.scrollTop-=20+this.selectIndex))},onEnterKey:function(){this.select(this.selectIndex)},select:function(t){this.displayText=this.options[t],this.search="",this.$emit("input",t),this.$refs.search.blur()},toggle:function(t){t.target!==this.$refs.toggle&&t.target!==this.$refs.search&&t.target!==this.$refs.text||(this.open?t.target!==this.$refs.search&&t.target!==this.$refs.text&&this.$refs.search.blur():this.$refs.search.focus())},onFocus:function(){this.open=!0},onBlur:function(){this.selectIndex=0,this.$refs.list.scrollTop=0,this.open=!1},onEscape:function(){this.$refs.search.blur()},onScroll:function(){this.count+=1}}});var vm=new Vue({el:"#calc",data:{citys:["Амвросиевка","Амвросиевский район","Донецк","Донецкий горсовет","Дебальцево","Дебальцевский горсовет","Докучаевск","Докучаевский горсовет","Горловка","Горловский горсовет","Енакиево","Енакиевский горсовет","Ждановка","Ждановский горсовет","Кировское","Кировский горсовет","Макеевка","Макеевский горсовет","Новоазовск","Новоазовский район","Снежное","Снежнянский горсовет","Старобешево","Старобешевский район","Тельманово","Тельмановский район","Торез","Торезский горсовет","Харцызск","Харцызский горсовет","Шахтерск","Шахтерский горсовет","Ясиноватая","Ясиноватский горсовет"],tableTZ:[[1,3,3,3,3,3,3,3,3,4,3,3,4,3,2,3,3],[3,1,3,3,3,3,3,3,1,4,3,3,4,3,2,3,2],[3,3,1,3,3,3,3,3,3,4,3,3,4,3,3,3,3],[3,3,3,1,3,3,3,3,3,4,3,2,3,3,3,3,3],[3,3,3,3,1,2,3,3,3,4,3,3,4,3,3,3,3],[3,3,3,3,2,1,2,2,3,4,3,3,4,3,3,3,3],[3,3,3,3,3,2,1,2,3,4,3,3,4,3,3,3,3],[3,3,3,3,3,2,2,1,3,4,3,3,4,3,3,3,3],[3,1,3,3,3,3,3,3,1,4,3,3,4,3,3,3,3],[4,4,4,4,4,4,4,4,4,1,4,4,3,4,4,4,4],[3,3,3,3,3,3,3,3,3,4,1,3,4,2,3,3,3],[3,3,3,2,3,3,3,3,3,4,3,1,3,3,3,3,3],[4,4,4,3,4,4,4,4,4,3,4,3,1,4,4,4,4],[3,3,3,3,3,3,3,3,3,4,3,3,4,1,3,2,3],[3,2,3,3,3,3,3,3,2,4,3,3,4,3,1,2,3],[3,3,3,3,3,3,3,3,3,4,3,3,4,2,2,1,3],[3,2,3,3,3,3,3,3,2,4,3,3,4,3,3,3,1]],tariff:[{min:0,max:2,prices:[0,65,80,120,200]},{min:2,max:5,prices:[0,75,100,150,240]},{min:5,max:10,prices:[0,95,120,180,300]},{min:10,max:20,prices:[0,130,150,220,350]},{min:20,max:35,prices:[0,165,180,270,410]},{min:35,max:50,prices:[0,210,230,350,470]},{min:50,max:1/0,prices:[[0,0],[210,.8],[230,1.5],[350,2.5],[470,3]]}],docsTarif:[0,60,70,80,90],direction:{from:void 0,to:void 0},typeOfLoad:"load",load:{weight:0,o:0,price:0},loadFields:[],cashPay:{active:!1,sum:!1},overlay:!1},computed:{bigDisplay:function(){return document.documentElement.clientWidth>=660},TZ:function(){var t=void 0,e=this.direction,i=e.from,n=e.to;return void 0!==i&&void 0!==n&&(i=Math.floor(i/2),n=Math.floor(n/2),t=this.tableTZ[n][i]),t},isRegion:function(){var t=this.direction,e=t.from,i=t.to;return!!(e%2||i%2)},period:function(){return this.isRegion?this.TZ+1:this.TZ},result:function(){return this.isRegion?Math.round(1.15*this.total):this.total},total:function(){var t=this;if(this.TZ>0){if("docs"===this.typeOfLoad)return this.docsTarif[this.TZ];var e=this.tariff[0],i=!0,n=function(){var e=250*t.load.o,i=t.load.weight,n=e>=i?e:i;return t.round(n)}();return n>0?(e=this.tariff.find(function(t,e,s){return e+1===s.length&&(i=!1),n>t.min&&n<=t.max}),[function(){var s=e.prices[t.TZ],o=i?s:s[0]+(n-50)*s[1];return t.round(o)}(),function(){if(t.load.price>0){var e=.0025*t.load.price;return t.round(e>5?e:5)}return 0}(),function(){var e=t.cashPay.sum,i=t.round(.01*e);return t.cashPay.active?10+i:0}()].reduce(function(t,e){return t+e},0)):0}}},methods:{round:function(t){return Math.round(100*t/100)},addPlace:function(){this.loadFields.push({weight:10,o:.05,d:0,s:0,v:0,price:500,isCalcO:!1}),this.addAll()},delPlace:function(t){this.loadFields.splice(t,1),this.addAll()},add:function(t){this.load[t]=0;for(var e=0;e<this.loadFields.length;e++)this.load[t]+=parseFloat(this.loadFields[e][t]);"object"===_typeof(window.event)&&this.validate(window.event)},addAll:function(){this.add("weight"),this.add("o"),this.add("price")},calcO:function(t){if("close"!==t){var e=this.loadFields[t];e.d&&e.s&&e.v&&(e.o=(e.d*e.s*e.v/1e6).toFixed(3)),this.addAll();var i=this.$refs.volume[0];i.classList?i.classList.remove("novalid"):i.className=i.className.replace(new RegExp("(^|\\b)"+"novalid".split(" ").join("|")+"(\\b|$)","gi")," ")}for(var n=0;n<this.loadFields.length;n++)1==this.loadFields[n].isCalcO&&(this.loadFields[n].isCalcO=!1);this.overlay=!1},goCalcO:function(t){this.overlay=!0;var e=this.loadFields[t];e.d=0,e.s=0,e.v=0,e.isCalcO=!e.isCalcO},validate:function(t){var e=t.target,i=e.value;"INPUT"==e.tagName&&(i<=0?e.classList.add("novalid"):e.classList.remove("novalid"))}},created:function(){this.addPlace()}});initForm("callback_form","callback"),initForm("callcouire_form","callcourier"),document.getElementById("isCashPay").onchange=function(t){var e=document.getElementById("cashPaySumm");e.style.display=t.target.checked?"block":"none",e.children[0].focus()};})})(window, document);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiaW5pdEZvcm0iLCJjbGFzc05hbWUiLCJwaHBTY3JpcHROYW1lIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImZvcm0iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0IiwicXVlcnlTZWxlY3RvciIsInZhbHVlIiwibGVuZ3RoIiwiYWxlcnQiLCIkIiwiYWpheCIsInR5cGUiLCJ1cmwiLCJkYXRhIiwic2VyaWFsaXplIiwic3VjY2VzcyIsInN1Y2Nlc3NGb3JtIiwiZXJyb3IiLCJpbnB1dCIsInBhcmVudCIsInBhcmVudE5vZGUiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInJlbW9kYWwiLCJjbG9zZSIsImJ1dHRvbnNDbGFzc0xpc3QiLCJnZXRFbGVtZW50QnlJZCIsImhlYWRlckhlaWdodCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwib2Zmc2V0SGVpZ2h0IiwiZml4ZWRDbGFzcyIsIndpbmRvdyIsImFkZCIsInJlbW92ZSIsIlZ1ZSIsImNvbXBvbmVudCIsImNvdW50Iiwib3B0aW9ucyIsIkFycmF5IiwiZGVmYXVsdCIsIlN0cmluZyIsIk51bWJlciIsImZpbHRlcmVkT3B0aW9ucyIsImRpcmVjdGlvblRleHQiLCJhZnRlckZpbHRlciIsInBhdGhPZkNpdHlOYW1lIiwib3BlbiIsInNlbGVjdEluZGV4IiwiZGlzcGxheVRleHQiLCJzZWFyY2giLCJjaXR5QSIsImNvbXB1dGVkIiwidHlwZWFoZWFkU3RhdGUiLCJjb21wYXJpc29uIiwidGhpcyIsIl90aGlzIiwiZmlsdGVyIiwib3B0aW9uIiwic3BsaXQiLCJzbGljZSIsImpvaW4iLCJ0b0xvd2VyQ2FzZSIsInNvcnQiLCJhIiwiYiIsImNpdHkiLCJ0b1VwcGVyQ2FzZSIsImNpdHlCIiwib25FbnRlcktleSIsIm9uRG93bktleSIsImlkIiwiYmx1ciIsImxpc3QiLCJzY3JvbGxUb3AiLCJvblVwS2V5IiwiJHJlZnMiLCJmb2N1cyIsIm9uRm9jdXMiLCJzZWxlY3QiLCJvbkJsdXIiLCIkZW1pdCIsInRvZ2dsZSIsInRhcmdldCIsInRleHQiLCJ0YWJsZVRaIiwib25Fc2NhcGUiLCJvblNjcm9sbCIsInZtIiwiZWwiLCJ0YXJpZmYiLCJkb2NzVGFyaWYiLCJkaXJlY3Rpb24iLCJ0eXBlT2ZMb2FkIiwibG9hZCIsIndlaWdodCIsIm8iLCJwcmljZSIsImxvYWRGaWVsZHMiLCJjYXNoUGF5IiwiYWN0aXZlIiwic3VtIiwib3ZlcmxheSIsImJpZ0Rpc3BsYXkiLCJ0byIsIk1hdGgiLCJmbG9vciIsInR6IiwiZnJvbSIsImlzUmVnaW9uIiwicGVyaW9kIiwiVFoiLCJyZXN1bHQiLCJyb3VuZCIsInRvdGFsIiwibWluIiwibWF4IiwicHJpY2VzIiwidW5kZWZpbmVkIiwiZG9jdW1lbnRFbGVtZW50IiwiY29taXNzU3VtIiwiX2RpcmVjdGlvbiIsImNvbWlzc05hbCIsIl9kaXJlY3Rpb24yIiwibWV0aG9kcyIsIl90aGlzMiIsImQiLCJpc0NhbGNPIiwiYWRkQWxsIiwiaW5kZXgiLCJmYWN0V2VpZ2h0IiwibWF4V2VpZ2h0Iiwidm9sdW1lV2VpZ2h0IiwicGFyYW0iLCJpIiwiaXRlbSIsImFycmF5IiwiaXNGaXhlZFByaWNlIiwidG90YWxQcmljZSIsInZvbHVtZSIsInJlZHVjZSIsInAiLCJjIiwibnVtIiwiZmllbGQiLCJ2IiwicHVzaCIsInZhbGlkYXRlIiwidGFnTmFtZSIsImNyZWF0ZWQiLCJhZGRQbGFjZSIsInNwbGljZSIsInBhcnNlRmxvYXQiLCJldmVudCIsImNhbGNPIiwicyIsInRvRml4ZWQiLCJpbnN0IiwiZWxlbSIsInJlcGxhY2UiLCJSZWdFeHAiLCJvbmNoYW5nZSIsImVsZW1Ub1Nob3ciLCJjaGlsZHJlbiIsImdvQ2FsY08iLCJzdHlsZSIsImRpc3BsYXkiLCJjaGVja2VkIl0sIm1hcHBpbmdzIjoibUdBNGJBLFNBQVNBLFNBQVNDLEVBQVdDLEdBQ3pCQyxTQUFTQyxpQkFBaUIsSUFBTUgsR0FBV0ksUUFB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QUFNakIsU0FBV2lCLEVBQU1qQixTQUkzQm9CLFNBQVUsU0FBU00sR0FDZixJQUFJaEUsRUFBS2dFLEVBQU10RSxPQUNYNUUsRUFBUWtGLEVBQUdsRixNQUVHLFNBQWRrRixFQUFHMkQsVUFDRjdJLEdBQVMsRUFBS2tGLEVBQUduRSxVQUFVVyxJQUFJLFdBQWF3RCxFQUFHbkUsVUFBVVksT0FBTyxjQUs3RW1ILFFBQVMsV0FDTDlGLEtBQUsrRixjQXVDVDFKLFNBQVMsZ0JBQWlCLFlBQzFCQSxTQUFTLGtCQUFtQixlQUdoQ0csU0FBUzRCLGVBQWUsYUFBYXNJLFNBQVcsU0FBQVIsR0FDNUMsSUFBTVMsRUFBYW5LLFNBQVM0QixlQUFlLGVBQzNDdUksRUFBV0csTUFBTUMsUUFBVWIsRUFBTXRFLE9BQU9vRixRQUFVLFFBQVUsT0FDNURMLEVBQVdDLFNBQVMsR0FBR3RGIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXJcclxuICBidXR0b25zQ2xhc3NMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvcHRidXR0b25zJykuY2xhc3NMaXN0LFxyXG4gIGhlYWRlckhlaWdodCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkZXInKVswXS5vZmZzZXRIZWlnaHQsXHJcbiAgZml4ZWRDbGFzcyA9ICdmaXhlZCc7XHJcblxyXG53aW5kb3cub25zY3JvbGwgPSBmdW5jdGlvbigpIHtcclxuICBpZiAod2luZG93LnBhZ2VZT2Zmc2V0ID49IGhlYWRlckhlaWdodCkgYnV0dG9uc0NsYXNzTGlzdC5hZGQoZml4ZWRDbGFzcyk7XHJcbiAgZWxzZSBpZiAoYnV0dG9uc0NsYXNzTGlzdC5jb250YWlucyhmaXhlZENsYXNzKSkgYnV0dG9uc0NsYXNzTGlzdC5yZW1vdmUoZml4ZWRDbGFzcyk7XHJcbn07XG5WdWUuY29tcG9uZW50KCd0eXBlYWhlYWQnLCB7XHJcbiAgICBcclxuICAgICAgICB0ZW1wbGF0ZTogYDxkaXYgOmNsYXNzPVwidHlwZWFoZWFkU3RhdGVcIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidHlwZWFoZWFkX190b2dnbGVcIiByZWY9XCJ0b2dnbGVcIiBAbW91c2Vkb3duLnByZXZlbnQ9XCJ0b2dnbGVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJ0eXBlYWhlYWRfX3NlYXJjaFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWY9XCJzZWFyY2hcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdi1tb2RlbC50cmltPVwic2VhcmNoXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBmb2N1cz1cIm9uRm9jdXNcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQGJsdXI9XCJvbkJsdXJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQGtleWRvd24uZXNjPVwib25Fc2NhcGVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQGtleWRvd24uZG93bj1cIm9uRG93bktleVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBAa2V5ZG93bi51cD1cIm9uVXBLZXlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQGtleWRvd24uZW50ZXI9XCJvbkVudGVyS2V5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInR5cGVhaGVhZF9fdGV4dFwiIHJlZj1cInRleHRcIj57e2Rpc3BsYXlUZXh0fX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPHVsIEBtb3VzZWRvd24ucHJldmVudC5zdG9wIGNsYXNzPVwidHlwZWFoZWFkX19saXN0XCIgcmVmPVwibGlzdFwiIHYtaWY9XCJvcGVuXCIgQHNjcm9sbD1cIm9uU2Nyb2xsXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxsaSBjbGFzcz1cInR5cGVhaGVhZF9faXRlbVwiIHYtZm9yPVwiKG9wdGlvbiwgaW5kZXgpIGluIGZpbHRlcmVkT3B0aW9uc1wiIDprZXk9XCJpbmRleFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9XCJ0eXBlYWhlYWRfX2xpbmtcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBtb3VzZWRvd24ucHJldmVudD1cInNlbGVjdChpbmRleClcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpjbGFzcz1cIltzZWxlY3RJbmRleCA9PT0gaW5kZXggPyAndHlwZWFoZWFkX19hY3RpdmUnIDogJyddXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3tvcHRpb259fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8bGkgY2xhc3M9XCJub19zZWFyY2hcIiB2LWlmPVwiZmlsdGVyZWRPcHRpb25zLmxlbmd0aCA9PT0gMFwiPtCT0L7RgNC+0LQg0L3QtSDQvdCw0LnQtNC10L0uLi48L2xpPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvdWw+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5gLFxyXG4gICAgICAgIHByb3BzOiB7XHJcbiAgICAgICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IEFycmF5LFxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDogKCkgPT4gW11cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdmFsdWU6IHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IFtTdHJpbmcsIE51bWJlcl0sXHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiBudWxsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRpcmVjdGlvblRleHQ6IHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IG51bGxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGF0YTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBvcGVuOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdEluZGV4OiAwLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheVRleHQ6IHRoaXMuZGlyZWN0aW9uVGV4dCxcclxuICAgICAgICAgICAgICAgIHNlYXJjaDogJycsXHJcbiAgICAgICAgICAgICAgICBjb3VudDogMTVcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbXB1dGVkOiB7XHJcbiAgICAgICAgICAgIHR5cGVhaGVhZFN0YXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm9wZW4gPyAndHlwZWFoZWFkIHR5cGVhaGVhZF9fb3BlbicgOiAndHlwZWFoZWFkJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBmaWx0ZXJlZE9wdGlvbnM6IGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICBjb25zdCBhZnRlckZpbHRlciA9IHRoaXMub3B0aW9ucy5maWx0ZXIob3B0aW9uID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXRoT2ZDaXR5TmFtZSA9IG9wdGlvbi5zcGxpdCgnJykuc2xpY2UoMCwgdGhpcy5zZWFyY2gubGVuZ3RoKS5qb2luKCcnKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWFyY2gudG9Mb3dlckNhc2UoKSA9PSBwYXRoT2ZDaXR5TmFtZS50b0xvd2VyQ2FzZSgpKSByZXR1cm4gb3B0aW9uO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIGlmIChhZnRlckZpbHRlci5sZW5ndGggPj0gdGhpcy5jb3VudClcclxuICAgICAgICAgICAgICAgICAgICBhZnRlckZpbHRlci5sZW5ndGggPSB0aGlzLmNvdW50O1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWFyY2gubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhZnRlckZpbHRlci5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNpdHlBID0gYS5jaXR5LnRvVXBwZXJDYXNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaXR5QiA9IGIuY2l0eS50b1VwcGVyQ2FzZSgpO1xyXG4gICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21wYXJpc29uID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNpdHlBID4gY2l0eUIpIGNvbXBhcmlzb24gPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChjaXR5QSA8IGNpdHlCKSBjb21wYXJpc29uID0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wYXJpc29uO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgcmV0dXJuIGFmdGVyRmlsdGVyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBtZXRob2RzOiB7XHJcbiAgICAgICAgICAgIG9uRG93bktleTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5maWx0ZXJlZE9wdGlvbnMubGVuZ3RoIC0gMSA+IHRoaXMuc2VsZWN0SW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEluZGV4KytcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzY3JvbGwgd2hlbiBvdmVyZmxvd1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RJbmRleCA+IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMubGlzdC5zY3JvbGxUb3AgKz0gKDIwICsgdGhpcy5zZWxlY3RJbmRleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgb25VcEtleTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RJbmRleCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEluZGV4LS07XHJcbiAgICBcclxuICAgICAgICAgICAgICAgICAgICAvLyBzY3JvbGwgd2hlbiBvdmVyZmxvd1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdEluZGV4ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLmxpc3Quc2Nyb2xsVG9wIC09ICgyMCArIHRoaXMuc2VsZWN0SW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgb25FbnRlcktleTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdCh0aGlzLnNlbGVjdEluZGV4KTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiBmdW5jdGlvbihpZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5VGV4dCA9IHRoaXMub3B0aW9uc1tpZF07XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCBpZCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLnNlYXJjaC5ibHVyKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRvZ2dsZTogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0ID09PSB0aGlzLiRyZWZzLnRvZ2dsZSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0ID09PSB0aGlzLiRyZWZzLnNlYXJjaCB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0ID09PSB0aGlzLiRyZWZzLnRleHQpIHtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0ICE9PSB0aGlzLiRyZWZzLnNlYXJjaCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS50YXJnZXQgIT09IHRoaXMuJHJlZnMudGV4dCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5zZWFyY2guYmx1cigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5zZWFyY2guZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG9uRm9jdXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vcGVuID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgb25CbHVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0SW5kZXggPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5saXN0LnNjcm9sbFRvcCA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9wZW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgb25Fc2NhcGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5zZWFyY2guYmx1cigpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvblNjcm9sbDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvdW50ICs9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICBcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxudmFyIHZtID0gbmV3IFZ1ZSh7XHJcblxyXG4gICAgZWw6ICcjY2FsYycsXHJcbiAgICBkYXRhOiB7XHJcblxyXG4gICAgICAgIGNpdHlzOiBbXHJcbiAgICAgICAgICAgICfQkNC80LLRgNC+0YHQuNC10LLQutCwJywgXHJcbiAgICAgICAgICAgICfQkNC80LLRgNC+0YHQuNC10LLRgdC60LjQuSDRgNCw0LnQvtC9JyxcclxuICAgICAgICAgICAgJ9CU0L7QvdC10YbQuicsXHJcbiAgICAgICAgICAgICfQlNC+0L3QtdGG0LrQuNC5INCz0L7RgNGB0L7QstC10YInLFxyXG4gICAgICAgICAgICAn0JTQtdCx0LDQu9GM0YbQtdCy0L4nLFxyXG4gICAgICAgICAgICAn0JTQtdCx0LDQu9GM0YbQtdCy0YHQutC40Lkg0LPQvtGA0YHQvtCy0LXRgicsXHJcbiAgICAgICAgICAgICfQlNC+0LrRg9GH0LDQtdCy0YHQuicsXHJcbiAgICAgICAgICAgICfQlNC+0LrRg9GH0LDQtdCy0YHQutC40Lkg0LPQvtGA0YHQvtCy0LXRgicsXHJcbiAgICAgICAgICAgICfQk9C+0YDQu9C+0LLQutCwJyxcclxuICAgICAgICAgICAgJ9CT0L7RgNC70L7QstGB0LrQuNC5INCz0L7RgNGB0L7QstC10YInLFxyXG4gICAgICAgICAgICAn0JXQvdCw0LrQuNC10LLQvicsXHJcbiAgICAgICAgICAgICfQldC90LDQutC40LXQstGB0LrQuNC5INCz0L7RgNGB0L7QstC10YInLFxyXG4gICAgICAgICAgICAn0JbQtNCw0L3QvtCy0LrQsCcsXHJcbiAgICAgICAgICAgICfQltC00LDQvdC+0LLRgdC60LjQuSDQs9C+0YDRgdC+0LLQtdGCJyxcclxuICAgICAgICAgICAgJ9Ca0LjRgNC+0LLRgdC60L7QtScsXHJcbiAgICAgICAgICAgICfQmtC40YDQvtCy0YHQutC40Lkg0LPQvtGA0YHQvtCy0LXRgicsXHJcbiAgICAgICAgICAgICfQnNCw0LrQtdC10LLQutCwJyxcclxuICAgICAgICAgICAgJ9Cc0LDQutC10LXQstGB0LrQuNC5INCz0L7RgNGB0L7QstC10YInLFxyXG4gICAgICAgICAgICAn0J3QvtCy0L7QsNC30L7QstGB0LonLFxyXG4gICAgICAgICAgICAn0J3QvtCy0L7QsNC30L7QstGB0LrQuNC5INGA0LDQudC+0L0nLFxyXG4gICAgICAgICAgICAn0KHQvdC10LbQvdC+0LUnLFxyXG4gICAgICAgICAgICAn0KHQvdC10LbQvdGP0L3RgdC60LjQuSDQs9C+0YDRgdC+0LLQtdGCJyxcclxuICAgICAgICAgICAgJ9Ch0YLQsNGA0L7QsdC10YjQtdCy0L4nLFxyXG4gICAgICAgICAgICAn0KHRgtCw0YDQvtCx0LXRiNC10LLRgdC60LjQuSDRgNCw0LnQvtC9JyxcclxuICAgICAgICAgICAgJ9Ci0LXQu9GM0LzQsNC90L7QstC+JyxcclxuICAgICAgICAgICAgJ9Ci0LXQu9GM0LzQsNC90L7QstGB0LrQuNC5INGA0LDQudC+0L0nLFxyXG4gICAgICAgICAgICAn0KLQvtGA0LXQtycsXHJcbiAgICAgICAgICAgICfQotC+0YDQtdC30YHQutC40Lkg0LPQvtGA0YHQvtCy0LXRgicsXHJcbiAgICAgICAgICAgICfQpdCw0YDRhtGL0LfRgdC6JyxcclxuICAgICAgICAgICAgJ9Cl0LDRgNGG0YvQt9GB0LrQuNC5INCz0L7RgNGB0L7QstC10YInLFxyXG4gICAgICAgICAgICAn0KjQsNGF0YLQtdGA0YHQuicsXHJcbiAgICAgICAgICAgICfQqNCw0YXRgtC10YDRgdC60LjQuSDQs9C+0YDRgdC+0LLQtdGCJyxcclxuICAgICAgICAgICAgJ9Cv0YHQuNC90L7QstCw0YLQsNGPJyxcclxuICAgICAgICAgICAgJ9Cv0YHQuNC90L7QstCw0YLRgdC60LjQuSDQs9C+0YDRgdC+0LLQtdGCJyxcclxuICAgICAgICBdLFxyXG5cclxuICAgICAgICB0YWJsZVRaOiBbXHJcbiAgICAgICAgLy8gICAwICAxICAyICAzICA0ICA1ICA2ICA3ICA4ICA5ICAxMCAxMSAxMiAxMyAxNCAxNSAxNiBcclxuICAgICAgICAgICAgWzEsIDMsIDMsIDMsIDMsIDMsIDMsIDMsIDMsIDQsIDMsIDMsIDQsIDMsIDIsIDMsIDMgXSwgLy8gMCAg0JDQvNCy0YDQvtGB0LjQtdCy0LrQsFxyXG4gICAgICAgICAgICBbMywgMSwgMywgMywgMywgMywgMywgMywgMSwgNCwgMywgMywgNCwgMywgMiwgMywgMiBdLCAvLyAxICDQlNC+0L3QtdGG0LpcclxuICAgICAgICAgICAgWzMsIDMsIDEsIDMsIDMsIDMsIDMsIDMsIDMsIDQsIDMsIDMsIDQsIDMsIDMsIDMsIDMgXSwgLy8gMiAg0JTQtdCx0LDQu9GM0YbQtdCy0L5cclxuICAgICAgICAgICAgWzMsIDMsIDMsIDEsIDMsIDMsIDMsIDMsIDMsIDQsIDMsIDIsIDMsIDMsIDMsIDMsIDMgXSwgLy8gMyAg0JTQvtC60YPRh9Cw0LXQstGB0LpcclxuICAgICAgICAgICAgWzMsIDMsIDMsIDMsIDEsIDIsIDMsIDMsIDMsIDQsIDMsIDMsIDQsIDMsIDMsIDMsIDMgXSwgLy8gNCAg0JPQvtGA0LvQvtCy0LrQsFxyXG4gICAgICAgICAgICBbMywgMywgMywgMywgMiwgMSwgMiwgMiwgMywgNCwgMywgMywgNCwgMywgMywgMywgMyBdLCAvLyA1ICDQldC90LDQutC40LXQstC+XHJcbiAgICAgICAgICAgIFszLCAzLCAzLCAzLCAzLCAyLCAxLCAyLCAzLCA0LCAzLCAzLCA0LCAzLCAzLCAzLCAzIF0sIC8vIDYgINCW0LTQsNC90L7QstC60LBcclxuICAgICAgICAgICAgWzMsIDMsIDMsIDMsIDMsIDIsIDIsIDEsIDMsIDQsIDMsIDMsIDQsIDMsIDMsIDMsIDMgXSwgLy8gNyAg0JrQuNGA0L7QstGB0LrQvtC1XHJcbiAgICAgICAgICAgIFszLCAxLCAzLCAzLCAzLCAzLCAzLCAzLCAxLCA0LCAzLCAzLCA0LCAzLCAzLCAzLCAzIF0sIC8vIDggINCc0LDQutC10LXQstC60LBcclxuICAgICAgICAgICAgWzQsIDQsIDQsIDQsIDQsIDQsIDQsIDQsIDQsIDEsIDQsIDQsIDMsIDQsIDQsIDQsIDQgXSwgLy8gOSAg0J3QvtCy0L7QsNC30L7QstGB0LpcclxuICAgICAgICAgICAgWzMsIDMsIDMsIDMsIDMsIDMsIDMsIDMsIDMsIDQsIDEsIDMsIDQsIDIsIDMsIDMsIDMgXSwgLy8gMTAg0KHQvdC10LbQvdC+0LVcclxuICAgICAgICAgICAgWzMsIDMsIDMsIDIsIDMsIDMsIDMsIDMsIDMsIDQsIDMsIDEsIDMsIDMsIDMsIDMsIDMgXSwgLy8gMTEg0KHRgtCw0YDQvtCx0LXRiNC10LLQvlxyXG4gICAgICAgICAgICBbNCwgNCwgNCwgMywgNCwgNCwgNCwgNCwgNCwgMywgNCwgMywgMSwgNCwgNCwgNCwgNCBdLCAvLyAxMiDQotC10LvRjNC80LDQvdC+0LLQvlxyXG4gICAgICAgICAgICBbMywgMywgMywgMywgMywgMywgMywgMywgMywgNCwgMywgMywgNCwgMSwgMywgMiwgMyBdLCAvLyAxMyDQotC+0YDQtdC3XHJcbiAgICAgICAgICAgIFszLCAyLCAzLCAzLCAzLCAzLCAzLCAzLCAyLCA0LCAzLCAzLCA0LCAzLCAxLCAyLCAzIF0sIC8vIDE0INCl0LDRgNGG0YvQt9GB0LpcclxuICAgICAgICAgICAgWzMsIDMsIDMsIDMsIDMsIDMsIDMsIDMsIDMsIDQsIDMsIDMsIDQsIDIsIDIsIDEsIDMgXSwgLy8gMTUg0KjQsNGF0YLQtdGA0YHQulxyXG4gICAgICAgICAgICBbMywgMiwgMywgMywgMywgMywgMywgMywgMiwgNCwgMywgMywgNCwgMywgMywgMywgMSBdICAvLyAxNiDQr9GB0LjQvdC+0LLQsNGC0LDRj1xyXG4gICAgICAgIF0sXHJcblxyXG4gICAgICAgIHRhcmlmZjogW1xyXG4gICAgICAgICAgICB7IG1pbjogIDAsIG1heDogIDIsIHByaWNlczogWzAsICA2NSwgIDgwLCAxMjAsIDIwMF0gfSxcclxuICAgICAgICAgICAgeyBtaW46ICAyLCBtYXg6ICA1LCBwcmljZXM6IFswLCAgNzUsIDEwMCwgMTUwLCAyNDBdIH0sXHJcbiAgICAgICAgICAgIHsgbWluOiAgNSwgbWF4OiAxMCwgcHJpY2VzOiBbMCwgIDk1LCAxMjAsIDE4MCwgMzAwXSB9LFxyXG4gICAgICAgICAgICB7IG1pbjogMTAsIG1heDogMjAsIHByaWNlczogWzAsIDEzMCwgMTUwLCAyMjAsIDM1MF0gfSxcclxuICAgICAgICAgICAgeyBtaW46IDIwLCBtYXg6IDM1LCBwcmljZXM6IFswLCAxNjUsIDE4MCwgMjcwLCA0MTBdIH0sXHJcbiAgICAgICAgICAgIHsgbWluOiAzNSwgbWF4OiA1MCwgcHJpY2VzOiBbMCwgMjEwLCAyMzAsIDM1MCwgNDcwXSB9LFxyXG4gICAgICAgICAgICB7IG1pbjogNTAsIG1heDogSW5maW5pdHksIHByaWNlczogW1swLCAwXSwgWzIxMCwgLjhdLCBbMjMwLCAxLjVdLCBbMzUwLCAyLjVdLCBbNDcwLCAzXV19XHJcbiAgICAgICAgXSxcclxuXHJcbiAgICAgICAgZG9jc1RhcmlmOiBbMCwgNjAsIDcwLCA4MCwgOTBdLFxyXG5cclxuICAgICAgICAvLyAg0J3QsNC/0YDQsNCy0LvQtdC90LjQtVxyXG4gICAgICAgIGRpcmVjdGlvbjogeyBmcm9tOiB1bmRlZmluZWQsIHRvOiB1bmRlZmluZWQgfSxcclxuXHJcbiAgICAgICAgLy8gINCi0LjQvyDQs9GA0YPQt9CwINC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOXHJcbiAgICAgICAgdHlwZU9mTG9hZDogJ2xvYWQnLFxyXG5cclxuICAgICAgICAvLyAg0JTQsNC90L3Ri9C1INCz0YDRg9C30LAg0LTQu9GPINGA0LDRgdGH0LXRgtCwXHJcbiAgICAgICAgbG9hZDoge1xyXG4gICAgICAgICAgICB3ZWlnaHQ6IDAsIC8vICDQktC10YFcclxuICAgICAgICAgICAgbzogMCwgLy8gINCe0LHRitC10LxcclxuICAgICAgICAgICAgcHJpY2U6IDAsIC8vICDQntGG0LXQvdC+0YfQvdCw0Y8g0YHRgtC+0LjQvNC+0YHRgtGMXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLy8gINCU0LDQvdC90YvQtSDQv9C+INCy0YHQtdC8INC80LXRgdGC0LDQvFxyXG4gICAgICAgIGxvYWRGaWVsZHM6IFtdLFxyXG5cclxuICAgICAgICAvLyAg0J3QsNC70L7QttC10L3QvdGL0Lkg0L/Qu9Cw0YLQtdC2XHJcbiAgICAgICAgY2FzaFBheToge1xyXG4gICAgICAgICAgICBhY3RpdmU6IGZhbHNlLFxyXG4gICAgICAgICAgICBzdW06IGZhbHNlXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgb3ZlcmxheTogZmFsc2VcclxuICAgIH0sXHJcblxyXG4gICAgY29tcHV0ZWQ6IHtcclxuXHJcbiAgICAgICAgYmlnRGlzcGxheSgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCA+PSA2NjA7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgVFooKSB7XHJcbiAgICAgICAgICAgIGxldCB0eixcclxuICAgICAgICAgICAgICAgIHsgZnJvbSwgdG8gfSA9IHRoaXMuZGlyZWN0aW9uO1xyXG4gICAgICAgICAgICBpZiAoZnJvbSAhPT0gdW5kZWZpbmVkICYmIHRvICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGZyb20gPSBNYXRoLmZsb29yKGZyb20vMik7XHJcbiAgICAgICAgICAgICAgICB0byA9IE1hdGguZmxvb3IodG8vMik7XHJcbiAgICAgICAgICAgICAgICB0eiA9IHRoaXMudGFibGVUWlt0b11bZnJvbV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHR6O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGlzUmVnaW9uKCkge1xyXG4gICAgICAgICAgICBjb25zdCB7IGZyb20sIHRvIH0gPSB0aGlzLmRpcmVjdGlvbjtcclxuICAgICAgICAgICAgcmV0dXJuICEhKGZyb20gJSAyIHx8IHRvICUgMik7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgcGVyaW9kKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gIXRoaXMuaXNSZWdpb24gPyB0aGlzLlRaIDogdGhpcy5UWiArIDFcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZXN1bHQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlzUmVnaW9uID8gTWF0aC5yb3VuZCh0aGlzLnRvdGFsICogMS4xNSkgOiB0aGlzLnRvdGFsO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8vICDQmtC+0L3QtdGH0L3Ri9C5INGA0LXQt9GD0LvRjNGC0LDRglxyXG4gICAgICAgIHRvdGFsKCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuVFogPiAwKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudHlwZU9mTG9hZCA9PT0gJ2RvY3MnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZG9jc1RhcmlmW3RoaXMuVFpdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGxldCAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgdGFyaWZmID0gdGhpcy50YXJpZmZbMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgaXNGaXhlZFByaWNlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyAg0JLRi9Cx0LjRgNCw0LXQvCDQvNCw0LrRgdC40LzQsNC70YzQvdC+0LUg0LfQvdCw0YfQtdC90LjQtSDQstC10YHQsCDQvNC10LbQtNGDINGE0LDQutGC0LjRh9C10YHQutC40Lwg0Lgg0L7QsdGK0LXQvNC90YvQvCDQstC10YHQsNC80LhcclxuICAgICAgICAgICAgICAgIGNvbnN0IHdlaWdodCA9ICgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgdm9sdW1lV2VpZ2h0ID0gdGhpcy5sb2FkLm8gKiAyNTAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RXZWlnaHQgICA9IHRoaXMubG9hZC53ZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heFdlaWdodCAgICA9ICh2b2x1bWVXZWlnaHQgPj0gZmFjdFdlaWdodCkgPyB2b2x1bWVXZWlnaHQgOiBmYWN0V2VpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJvdW5kKG1heFdlaWdodCk7XHJcbiAgICAgICAgICAgICAgICB9KSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vINCe0L/RgNC10LTQtdC70Y/QtdC8INGC0LDRgNC40YQg0L/QviDRgNCw0YHRgdGH0LjRgtCw0L3QvdC+0LzRgyDQstC10YHRg1xyXG4gICAgICAgICAgICAgICAgaWYgKHdlaWdodCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0YXJpZmYgPSB0aGlzLnRhcmlmZi5maW5kKChpdGVtLCBpbmRleCwgYXJyYXkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gINCV0YHQu9C4INCy0YvQsdGA0LDQvSDQv9C+0YHQu9C10LTQvdC40Lkg0YLQsNGA0LjRhCAtINC30L3QsNGH0LjRgiDQstC10YEgPiA1MCDQutCzINC4INGG0LXQvdCwINGD0LbQtSDQvdC1INGE0LjQutGB0LjRgNC+0LLQsNC90L3QsNGPXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoaW5kZXggKyAxKSA9PT0gYXJyYXkubGVuZ3RoKSBpc0ZpeGVkUHJpY2UgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICh3ZWlnaHQgPiBpdGVtLm1pbiAmJiB3ZWlnaHQgPD0gaXRlbS5tYXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdW1zID0gW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmljZSA9IHRhcmlmZi5wcmljZXNbdGhpcy5UWl0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxQcmljZSA9IGlzRml4ZWRQcmljZSA/IHByaWNlIDogKHByaWNlWzBdICsgKHdlaWdodCAtIDUwKSAqIHByaWNlWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJvdW5kKHRvdGFsUHJpY2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSgpLFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gINCh0YfQuNGC0LDQtdC8INC60L7QvNC40YHRgdC40Y4g0L7RgiDQvtGG0LXQvdC+0YfQvdC+0Lkg0YHRgtC+0LjQvNC+0YHRgtC4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5sb2FkLnByaWNlID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbWlzc1N1bSA9IHRoaXMubG9hZC5wcmljZSAqIDAuMDAyNTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yb3VuZCgoY29taXNzU3VtID4gNSkgPyBjb21pc3NTdW0gOiA1KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSByZXR1cm4gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkoKSxcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICDQodGH0LjRgtCw0LXQvCDQvdCw0LvQvtC20LXQvdC90YvQuSDQv9C70LDRgtC10LZcclxuICAgICAgICAgICAgICAgICAgICAgICAgKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VtbSA9IHRoaXMuY2FzaFBheS5zdW0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29taXNzTmFsID0gdGhpcy5yb3VuZChzdW1tICogMC4wMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jYXNoUGF5LmFjdGl2ZSA/IDEwICsgY29taXNzTmFsIDogMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkoKSxcclxuICAgICAgICAgICAgICAgICAgICBdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3Vtcy5yZWR1Y2UoKHAsIGMpID0+IHAgKyBjLCAwKTtcclxuICAgICAgICAgICAgICAgIH0gICBlbHNlIHJldHVybiAwOyBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgbWV0aG9kczoge1xyXG5cclxuICAgICAgICByb3VuZChudW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoKG51bSAqIDEwMCkgLyAxMDApO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8vICDQlNC+0LHQsNCy0LjRgtGMINC80LXRgdGC0L5cclxuICAgICAgICBhZGRQbGFjZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9hZEZpZWxkcy5wdXNoKHtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyAg0JTQsNC90L3Ri9C1INC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOXHJcbiAgICAgICAgICAgICAgICB3ZWlnaHQ6IDEwLFxyXG4gICAgICAgICAgICAgICAgbzogMC4wNSxcclxuICAgICAgICAgICAgICAgIGQ6IDAsXHJcbiAgICAgICAgICAgICAgICBzOiAwLFxyXG4gICAgICAgICAgICAgICAgdjogMCxcclxuICAgICAgICAgICAgICAgIHByaWNlOiA1MDAsXHJcbiAgICAgICAgICAgICAgICBpc0NhbGNPOiBmYWxzZSwgLy8g0KDQsNGB0YHRh9C40YLRi9Cy0LDRgtGMINC70Lgg0L7QsdGK0LXQvFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5hZGRBbGwoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvLyAg0KPQtNCw0LvQuNGC0Ywg0LzQtdGB0YLQvlxyXG4gICAgICAgIGRlbFBsYWNlOiBmdW5jdGlvbihpbmRleCkge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRGaWVsZHMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgdGhpcy5hZGRBbGwoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvLyAg0KHQu9C+0LbQuNGC0Ywg0L/QsNGA0LDQvNC10YLRgCDQvNC10YHRglxyXG4gICAgICAgIGFkZDogZnVuY3Rpb24ocGFyYW0pIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXNbJ2xvYWQnXVtwYXJhbV0gPSAwO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubG9hZEZpZWxkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdGhpc1snbG9hZCddW3BhcmFtXSArPSBwYXJzZUZsb2F0KHRoaXMubG9hZEZpZWxkc1tpXVtwYXJhbV0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyAg0JXRgdC70Lgg0YTRg9C90LrQuNGPINC30LDQv9GD0YnQtdC90LAgRE9NLdGN0LvQtdC80LXQvdGC0L7QvCAtINCy0LDQu9C40LTQuNGA0YPQtdC8XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93LmV2ZW50ID09PSAnb2JqZWN0JylcclxuICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGUod2luZG93LmV2ZW50KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvLyAg0KHQu9C+0LbQuNGC0Ywg0LLRgdC1INC/0LDRgNCw0LzQtdGC0YDRiyDQvNC10YHRglxyXG4gICAgICAgIGFkZEFsbDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkKCd3ZWlnaHQnKTtcclxuICAgICAgICAgICAgdGhpcy5hZGQoJ28nKTtcclxuICAgICAgICAgICAgdGhpcy5hZGQoJ3ByaWNlJyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLy8gINCg0LDRgdGH0LXRgtC90YvQuSDQvtCx0YrQtdC8XHJcbiAgICAgICAgY2FsY086IGZ1bmN0aW9uKGluZGV4KSB7XHJcblxyXG4gICAgICAgICAgICBpZiAoaW5kZXggIT09ICdjbG9zZScpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmxvYWRGaWVsZHNbaW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChmaWVsZC5kICYmIGZpZWxkLnMgJiYgZmllbGQudilcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZC5vID0gKChmaWVsZC5kICogZmllbGQucyAqIGZpZWxkLnYpIC8gMTAwMDAwMCkudG9GaXhlZCgzKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEFsbCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGVsZW0gPSB0aGlzLiRyZWZzLnZvbHVtZVswXTtcclxuICAgICAgICAgICAgICAgIGlmIChlbGVtLmNsYXNzTGlzdClcclxuICAgICAgICAgICAgICAgICAgICBlbGVtLmNsYXNzTGlzdC5yZW1vdmUoJ25vdmFsaWQnKTtcclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBlbGVtLmNsYXNzTmFtZSA9IGVsZW0uY2xhc3NOYW1lLnJlcGxhY2UobmV3IFJlZ0V4cCgnKF58XFxcXGIpJyArICdub3ZhbGlkJy5zcGxpdCgnICcpLmpvaW4oJ3wnKSArICcoXFxcXGJ8JCknLCAnZ2knKSwgJyAnKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxvYWRGaWVsZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxvYWRGaWVsZHNbaV0uaXNDYWxjTyA9PSB0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZEZpZWxkc1tpXS5pc0NhbGNPID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5vdmVybGF5ID0gZmFsc2U7ICAgICAgICAgICAgICAgIFxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8vICDQntGC0LrRgNGL0LLQsNC10Lwg0YDQsNGB0YfQtdGCINC/0L4g0LPQsNCx0LDRgNC40YLQsNC8XHJcbiAgICAgICAgZ29DYWxjTzogZnVuY3Rpb24oaW5kZXgpIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXMub3ZlcmxheSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmxvYWRGaWVsZHNbaW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgZmllbGQuZCA9IDA7XHJcbiAgICAgICAgICAgIGZpZWxkLnMgPSAwO1xyXG4gICAgICAgICAgICBmaWVsZC52ID0gMDtcclxuXHJcbiAgICAgICAgICAgIGZpZWxkLmlzQ2FsY08gPSAhZmllbGQuaXNDYWxjTztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvLyAg0JLQsNC70LjQtNCw0YbQuNGPINC/0L7Qu9C10LlcclxuICAgICAgICB2YWxpZGF0ZTogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgdmFyIGVsID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBlbC52YWx1ZTtcclxuXHJcbiAgICAgICAgICAgIGlmIChlbC50YWdOYW1lID09ICdJTlBVVCcpIHtcclxuICAgICAgICAgICAgICAgICh2YWx1ZSA8PSAwKSA/IGVsLmNsYXNzTGlzdC5hZGQoJ25vdmFsaWQnKSA6IGVsLmNsYXNzTGlzdC5yZW1vdmUoJ25vdmFsaWQnKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBjcmVhdGVkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmFkZFBsYWNlKCk7XHJcbiAgICB9XHJcblxyXG59KTtcbmZ1bmN0aW9uIGluaXRGb3JtKGNsYXNzTmFtZSwgcGhwU2NyaXB0TmFtZSkge1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicgKyBjbGFzc05hbWUpLmZvckVhY2goZm9ybSA9PiB7XHJcblxyXG4gICAgICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIFxyXG4gICAgICAgICAgICB2YXIgcGhvbmUgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy50ZWxsJykudmFsdWU7XHJcbiAgICAgICAgICAgIGlmIChwaG9uZS5sZW5ndGggPCAxMCkgcmV0dXJuIGFsZXJ0KCfQo9Cx0LXQtNC40YLQtdGB0Ywg0LIg0L/RgNCw0LLQuNC70YzQvdC+0YHRgtC4INCy0LLQtdC00LXQvdC90L7Qs9C+INC90L7QvNC10YDQsCDRgtC10LvQtdGE0L7QvdCwIScpO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBgLi4vcGhwLyR7cGhwU2NyaXB0TmFtZX0ucGhwYCxcclxuICAgICAgICAgICAgICAgIGRhdGE6ICQoZm9ybSkuc2VyaWFsaXplKCksXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydCgn0KHQv9Cw0YHQuNCx0L4g0LfQsCDQvtCx0YDQsNGJ0LXQvdC40LUsINC+0LbQuNC00LDQudGC0LUg0LfQstC+0L3QutCwINC+0L/QtdGA0LDRgtC+0YDQsCEnKTtcclxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzRm9ybShmb3JtKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ9Cd0LXQv9GA0LXQtNCy0LjQtNC10L3QvdCw0Y8g0L7RiNC40LHQutCwINGB0LXRgNCy0LXRgNCwLCDQvtCx0YDQsNGC0LjRgtC10YHRjCDQv9C+0LfQttC1Li4uJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sIGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdWNjZXNzRm9ybShmb3JtKSB7XHJcbiAgICBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0Om5vdChbdHlwZT1cInN1Ym1pdFwiXSknKS5mb3JFYWNoKGlucHV0ID0+IGlucHV0LnZhbHVlID0gXCJcIik7XHJcbiAgICBjb25zdCBwYXJlbnQgPSBmb3JtLnBhcmVudE5vZGU7XHJcbiAgICBpZiAocGFyZW50LmNsYXNzTGlzdC5jb250YWlucygncmVtb2RhbCcpKSB7XHJcbiAgICAgICAgY29uc3QgaW5zdCA9ICQocGFyZW50KS5yZW1vZGFsKCk7XHJcbiAgICAgICAgaW5zdC5jbG9zZSgpO1xyXG4gICAgfVxyXG59XHJcblxyXG4gICAgICAgIFxyXG4gICAgaW5pdEZvcm0oJ2NhbGxiYWNrX2Zvcm0nLCAnY2FsbGJhY2snKTtcclxuICAgIGluaXRGb3JtKCdjYWxsY291aXJlX2Zvcm0nLCAnY2FsbGNvdXJpZXInKTtcclxuXHJcblxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lzQ2FzaFBheScpLm9uY2hhbmdlID0gZXZlbnQgPT4ge1xyXG4gICAgY29uc3QgZWxlbVRvU2hvdyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYXNoUGF5U3VtbScpO1xyXG4gICAgZWxlbVRvU2hvdy5zdHlsZS5kaXNwbGF5ID0gZXZlbnQudGFyZ2V0LmNoZWNrZWQgPyAnYmxvY2snIDogJ25vbmUnO1xyXG4gICAgZWxlbVRvU2hvdy5jaGlsZHJlblswXS5mb2N1cygpO1xyXG59XHJcblxyXG5cclxuXHJcbiJdfQ==
